define("scalejs",["es5-shim","json2"],function(){return{load:function(e,t,n,r){var i=r.scalejs?r.scalejs.extensions||[]:[],s="scalejs/"+e;t([s],function(e){s==="scalejs/application"?t(i,function(){n(e)}):n(e)})}}}),define("scalejs/base.type",[],function(){function e(e){if(e===undefined)return"undefined";if(e===null)return"null";var t={}.toString.call(e).match(/\s([a-z|A-Z]+)/)[1].toLowerCase(),n;return t!=="object"?t:(n=e.constructor.toString().match(/^function\s*([$A-Z_][0-9A-Z_$]*)/i),n===null?"object":n[1])}function t(e){var n,r,i=arguments.length,s=i-1,o,u,a,f=e;if(i===0)return!1;if(i===1)return e!==null&&e!==n;if(i>2)for(r=0;r<s-1;r+=1){if(!t(f))return!1;f=f[arguments[r+1]]}return o=arguments[s],f===null?o===null||o==="null":f===n?o===n||o==="undefined":o===""?f===o:(u=typeof o,u==="string"?(a=Object.prototype.toString.call(f).slice(8,-1).toLowerCase(),a===o):u==="function"?f instanceof o:f===o)}return{is:t,typeOf:e}}),define("scalejs/base.object",["./base.type"],function(e){function n(e){var n,r,i=e,s;if(!t(i))return!1;for(n=1,r=arguments.length;n<r;n+=1){s=arguments[n],i=i[s];if(!t(i))return!1}return!0}function r(e,t){var i;for(i in t)t.hasOwnProperty(i)&&(n(t,i)&&t[i].constructor===Object&&n(e,i)?e[i]=r(e[i],t[i]):e[i]=t[i]);return e}function i(){var e=arguments,t,n=e.length,i={};for(t=0;t<n;t+=1)r(i,e[t]);return i}function s(e){return i({},e)}function o(e,t,i){var s=n(i)?i.split("."):[],o=e,u;for(u=0;u<s.length;u+=1)n(o,s[u])||(o[s[u]]={}),o=o[s[u]];return r(o,t),o}function u(e,t,r){var i=t.split("."),s,o,u=!0;for(s=0;s<i.length;s+=1){o=i[s];if(!n(e,o)){u=!1;break}e=e[o]}return u?e:r}function a(e,t){return n(e)?e:t}var t=e.is;return{has:n,valueOrDefault:a,merge:i,extend:o,clone:s,get:u}}),define("scalejs/base.array",["./base.object"],function(e){function n(e,t){e.indexOf(t)<0&&e.push(t)}function r(e,t){var n=e.indexOf(t);n>-1&&e.splice(n,1)}function i(e){e.splice(0,e.length)}function s(e,n,r){return n=t(n,0),r=t(r,e.length),Array.prototype.slice.call(e,n,r)}function o(e,t,n){var r,i;for(r=0,i=e.length;r<i;r+=1)if(e.hasOwnProperty(r)&&t.call(n,e[r],r,e))return e[r];return null}function u(e,t,n){var r=[],i,o;for(i=e.length;i--;r[i]=e[i]);return o=s(r,t,n),o}var t=e.valueOrDefault;return{addOne:n,removeOne:r,removeAll:i,copy:s,find:o,toArray:u}}),define("scalejs/base.log",[],function(){var e=["log","info","warn","error"],t={};return window.console!==undefined?(typeof console.log=="object"?e.forEach(function(e){t[e]=this.bind(console[e],console)},Function.prototype.call):e.forEach(function(e){t[e]=console[e].bind(console)}),typeof console.debug=="function"?t.debug=console.debug.bind(console):t.debug=t.info):(e.forEach(function(e){t[e]=function(){}}),e.debug=function(){}),t.formatException=function(e){var t=e.stack?String(e.stack):"",n=e.message||"";return"Error: "+n+"\nStack: "+t},t}),define("scalejs/base.functional",["./base.object","./base.array"],function(e,t){function i(){var e=Array.prototype.slice.call(arguments,0).reverse();return function(){var t=e.reduce(function(e,t){return[t.apply(undefined,e)]},Array.prototype.slice.call(arguments));return t[0]}}function s(){var e=Array.prototype.slice.call(arguments,0);return function(){var t=e.reduce(function(e,t){return[t.apply(undefined,e)]},Array.prototype.slice.call(arguments,0));return t[0]}}function o(e,t){var n=Array.prototype.slice.call(arguments,2);return function(){return t.apply(e,n.concat(Array.prototype.slice.call(arguments,0)))}}function u(e,t){return function(){return e.apply(undefined,Array.prototype.slice.call(arguments,0,t))}}function a(e,t){if(arguments.length===1)return a(e,e.length);var n=Array.prototype.slice.call(arguments,2);return n.length>=t?e.apply(undefined,n):function(){var r=n.concat(Array.prototype.slice.call(arguments,0));return r.unshift(e,t),a.apply(undefined,r)}}function f(){var e=Array.prototype.slice.call(arguments,0),t=e.reduce(function(e,t,n){return t===r?e.concat([n]):e},[]);return t.length===0?e[0].apply(undefined,e.slice(1)):function(){var n;for(n=0;n<Math.min(t.length,arguments.length);n+=1)e[t[n]]=arguments[n];return f.apply(undefined,e)}}function l(){function e(e){function i(){return{}}function s(e,t){if(!t||t.kind!=="$")return t;if(typeof t.expr=="function")return t.expr.call(e);if(typeof t.expr=="string")return e[t.expr];throw new Error("Parameter in $(...) must be either a function or a string referencing a binding.")}function o(i,o,u,a){function f(e){return e==="$return"||e==="$RETURN"||e==="$yield"||e==="$YIELD"}if(typeof e[i]!="function")throw new Error("This control construct may only be used if the computation expression builder defines a `"+i+"` method.");var l=s(o,u);if(a.length>0){if(typeof e.combine!="function")throw new Error("This control construct may only be used if the computation expression builder defines a `combine` method.");if(!f(i))return i==="$for"?e.combine(e.$for(u.items,function(e){var i=t.copy(u.cexpr),s=n(o);return s[u.name]=e,r(s,i)}),r(o,a)):e.combine(e[i].call(o,l),r(o,a));if(typeof e.delay!="function")throw new Error("This control construct may only be used if the computation expression builder defines a `delay` method.");return e.combine(e[i].call(o,l),e.delay.call(o,function(){return r(o,a)}))}return f(i)?e[i].call(o,l):e.combine(e[i].call(o,l),r(o,a))}var r;return e.missing||(e.missing=function(e){throw e.kind?new Error('Unknown operation "'+e.kind+'". '+"Either define `missing` method on the builder or fix the spelling of the operation."):new Error("Expression "+JSON.stringify(e)+" cannot be processed. "+"Either define `missing` method on the builder or convert expression to a function.")}),r=function(t,n){if(n.length===0){if(e.zero)return e.zero();throw new Error("Computation expression builder must define `zero` method.")}var i=n.shift();return i.kind==="let"?(t[i.name]=s(t,i.expr),r(t,n)):i.kind==="do"?(i.expr.call(t),r(t,n)):i.kind==="letBind"?e.bind.call(t,s(t,i.expr),function(e){return t[i.name]=e,r(t,n)}):i.kind==="doBind"||i.kind==="$"?e.bind.call(t,i.expr.bind(t),function(){return r(t,n)}):i.kind==="$return"||i.kind==="$RETURN"||i.kind==="$yield"||i.kind==="$YIELD"?o(i.kind,t,i.expr,n):i.kind==="$for"?o("$for",t,i,n):typeof i=="function"&&e.call?(e.call(t,i),r(t,n)):typeof i=="function"?(i.call(t,i),r(t,n)):o("missing",t,i,n)},function(){function o(){var e={mixins:Array.prototype.slice.call(arguments,0)},t=s.bind(e);return t.mixin=function(){return Array.prototype.push.apply(e.mixins,arguments),t},t}var n=t.copy(arguments),s=function(){var t=Array.prototype.slice.call(arguments,0),s=i(),o,u;return this.mixins&&this.mixins.forEach(function(e){e.beforeBuild&&e.beforeBuild(s,t)}),e.delay?u=e.delay(function(){return r(s,t)}):u=r(s,t),e.run?o=e.run.apply(null,[u].concat(n)):o=u,this.mixins&&this.mixins.forEach(function(e){e.afterBuild&&(o=e.afterBuild(o))}),o};return s.mixin=o,s}}return e.$let=function(e,t){return{kind:"let",name:e,expr:t}},e.$LET=function(e,t){return{kind:"letBind",name:e,expr:t}},e.$do=function(e){return{kind:"do",expr:e}},e.$DO=function(e){return{kind:"doBind",expr:e}},e.$return=function(e){return{kind:"$return",expr:e}},e.$RETURN=function(e){return{kind:"$RETURN",expr:e}},e.$yield=function(e){return{kind:"$yield",expr:e}},e.$YIELD=function(e){return{kind:"$YIELD",expr:e}},e.$for=function(e,t){var n=Array.prototype.slice.call(arguments,2);return{kind:"$for",name:e,items:t,cexpr:n}},e.$=function(e){return{kind:"$",expr:e}},e}var n=e.merge,r={};return{_:r,compose:i,sequence:s,bind:o,aritize:u,curry:a,partial:f,builder:l()}}),define("scalejs/base",["./base.array","./base.log","./base.object","./base.type","./base.functional"],function(e,t,n,r,i){return{type:r,object:n,array:e,log:t,functional:i}}),define("scalejs/sandbox",[],function(){function e(e,t){function n(){return e}return{getId:n,object:t.object,type:t.type,log:t.log,array:t.array,functional:t.functional,onApplicationStarted:t.onApplicationStarted}}return e}),define("scalejs/core",["./base","./sandbox"],function(e,t){function c(e){try{if(r(e,"function")){var t=e(u);t&&(i(u,t),s(a,t));return}if(r(e,"buildCore"," function")){e.buildCore(u),s(a,e);return}if(n(e,"core")){i(u,e.core),s(a,e);return}i(u,e),s(a,e)}catch(f){o("Fatal error during application initialization. ",'Failed to build core with extension "',e,"See following exception for more details.",f)}}function h(e){if(!n(e))throw new Error("Module is is required to builder sandbox.");var s=t(e,u);return a.forEach(function(e){try{if(r(e,"buildSandbox","function")){e.buildSandbox(s);return}if(n(e,"sandbox")){i(s,e.sandbox);return}i(s,e)}catch(t){throw o("Fatal error during application initialization. ",'Failed to build sandbox with extension "',e,"See following exception for more details.",t),t}}),s}function p(e){f.push(e)}function d(){if(l)return;l=!0,f.forEach(function(e){e("started")})}function v(){if(!l)return;l=!1,f.forEach(function(e){e("stopped")})}var n=e.object.has,r=e.type.is,i=e.object.extend,s=e.array.addOne,o=e.log.error,u={},a=[],f=[],l=!1;return i(u,{type:e.type,object:e.object,array:e.array,log:e.log,functional:e.functional,buildSandbox:h,notifyApplicationStarted:d,notifyApplicationStopped:v,onApplicationEvent:p,isApplicationRunning:function(){return l},registerExtension:c})}),define("scalejs/application",["scalejs!core"],function(e){function l(){var t,o;if(e.isApplicationRunning())throw t=n(arguments).reduce(function(e,t){return e+","+t}),new Error("Can't register module \""+t+'" since the application is already running.',"Dynamic module loading is not supported.");o=n(arguments).filter(r(s,i,"getModuleId")),Array.prototype.push.apply(a,o)}function c(e){var n;try{return n=e.newInstance(),t(f,n),n}catch(r){o('Failed to create an instance of module "'+e.getModuleId()+'".',"Application will continue running without the module. See following exception stack for more details.",r.stack)}}function h(){a.forEach(function(e){c(e)})}function p(){u("Application started."),e.notifyApplicationStarted()}function d(){h(),p()}function v(){u("Application exited."),e.notifyApplicationStopped()}var t=e.array.addOne,n=e.array.toArray,r=e.functional.partial,i=e.functional._,s=e.object.has,o=e.log.error,u=e.log.debug,a=[],f=[];return{registerModules:l,run:d,exit:v}}),define("scalejs/module",["./core"],function(e){function t(t,n){function r(){return t}function i(){var i,s;return s=e.buildSandbox(t),s.getModuleId=function(){return t},i=n(s),{toString:r}}return{getModuleId:r,toString:r,newInstance:i}}return t});